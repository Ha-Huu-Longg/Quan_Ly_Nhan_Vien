{"ast":null,"code":"import _objectSpread from \"D:\\\\DATA\\\\QL_NV\\\\QLNV\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _regeneratorRuntime from \"D:\\\\DATA\\\\QL_NV\\\\QLNV\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\DATA\\\\QL_NV\\\\QLNV\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"D:\\\\DATA\\\\QL_NV\\\\QLNV\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\DATA\\\\QL_NV\\\\QLNV\\\\src\\\\app\\\\views\\\\CreateStaff\\\\DialogStaff\\\\index.jsx\";\n\nimport React from \"react\";\nimport { Button, Form, Modal } from 'antd';\nimport moment from \"moment\";\nimport { useState } from \"react\";\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { Tabs } from 'antd';\nimport TabStaffInformation from \"./TabStaffInformation\";\nimport TabDiploma from \"./TabDiploma\";\nimport TabFamilyRelationShip from \"./TabFamilyRelationship\";\nimport { useEffect } from \"react\";\nimport DialogRegister from \"./DialogRegister\";\nimport { addNewStaff, getStaffById, updateStaff } from \"../CreateStaffService\";\nimport { isEmpty } from \"lodash\";\nimport { useDispatch } from \"react-redux\";\nimport { getFormStaff } from \"app/redux/actions/CreateStaffAction\";\nvar TabPane = Tabs.TabPane;\ntoast.configure({\n  autoClose: 500,\n  draggable: false,\n  limit: 3\n});\n\nvar DialogStaff = function DialogStaff(_ref) {\n  var open = _ref.open,\n      handleClose = _ref.handleClose,\n      employeeId = _ref.employeeId,\n      setEmployeeId = _ref.setEmployeeId,\n      employeeInfo = _ref.employeeInfo;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      listRelationship = _useState2[0],\n      setListRelationship = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      listDiploma = _useState4[0],\n      setListDiploma = _useState4[1];\n\n  var _useState5 = useState({}),\n      _useState6 = _slicedToArray(_useState5, 2),\n      staffInfo = _useState6[0],\n      setStaffInfo = _useState6[1];\n\n  var _useState7 = useState('1'),\n      _useState8 = _slicedToArray(_useState7, 2),\n      currentTab = _useState8[0],\n      setCurrentTab = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      fileImage = _useState10[0],\n      setFileImage = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      shouldOpenDialogRegister = _useState12[0],\n      setShouldOpenDialogRegister = _useState12[1];\n\n  var _useState13 = useState(!employeeId),\n      _useState14 = _slicedToArray(_useState13, 2),\n      isCheckDisableRegister = _useState14[0],\n      setIsCheckDisableRegister = _useState14[1];\n\n  var dispatch = useDispatch();\n  useEffect(function () {\n    dispatch(getFormStaff(employeeInfo));\n  }, []);\n  var listGender = [{\n    value: 0,\n    label: 'Nam'\n  }, {\n    value: 1,\n    label: 'Nữ'\n  }];\n\n  var _Form$useForm = Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var handleTabChange = function handleTabChange(tab) {\n    form.validateFields().then(function (values) {\n      setCurrentTab(tab);\n    }).catch(function (errorInfo) {\n      console.log('Validate Failed:', errorInfo);\n    });\n  };\n\n  var handleGetStaffById = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(employeeId) {\n      var _res$data, _res$data2, _res$data2$data, _res$data2$data$emplo, _res$data3, _res$data3$data, _res$data4, _res$data4$data, _res$data5, _res$data5$data, _employeeInfo$dateOfB;\n\n      var res, employeeInfo;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return getStaffById({\n                employeeId: employeeId\n              });\n\n            case 2:\n              res = _context.sent;\n              setStaffInfo(res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.data);\n              setFileImage(res === null || res === void 0 ? void 0 : (_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : (_res$data2$data = _res$data2.data) === null || _res$data2$data === void 0 ? void 0 : (_res$data2$data$emplo = _res$data2$data.employeeInfo) === null || _res$data2$data$emplo === void 0 ? void 0 : _res$data2$data$emplo.photoUrl);\n              setListRelationship(res === null || res === void 0 ? void 0 : (_res$data3 = res.data) === null || _res$data3 === void 0 ? void 0 : (_res$data3$data = _res$data3.data) === null || _res$data3$data === void 0 ? void 0 : _res$data3$data.familyRelations);\n              setListDiploma(res === null || res === void 0 ? void 0 : (_res$data4 = res.data) === null || _res$data4 === void 0 ? void 0 : (_res$data4$data = _res$data4.data) === null || _res$data4$data === void 0 ? void 0 : _res$data4$data.certificates);\n              employeeInfo = res === null || res === void 0 ? void 0 : (_res$data5 = res.data) === null || _res$data5 === void 0 ? void 0 : (_res$data5$data = _res$data5.data) === null || _res$data5$data === void 0 ? void 0 : _res$data5$data.employeeInfo;\n              form.setFieldsValue({\n                address: employeeInfo === null || employeeInfo === void 0 ? void 0 : employeeInfo.address,\n                code: employeeInfo === null || employeeInfo === void 0 ? void 0 : employeeInfo.code,\n                citizenId: employeeInfo === null || employeeInfo === void 0 ? void 0 : employeeInfo.citizenId,\n                dateOfBirth: employeeInfo === null || employeeInfo === void 0 ? void 0 : (_employeeInfo$dateOfB = employeeInfo.dateOfBirth) === null || _employeeInfo$dateOfB === void 0 ? void 0 : _employeeInfo$dateOfB.split(\" \")[0],\n                email: employeeInfo === null || employeeInfo === void 0 ? void 0 : employeeInfo.email,\n                fullName: employeeInfo === null || employeeInfo === void 0 ? void 0 : employeeInfo.fullName,\n                gender: employeeInfo === null || employeeInfo === void 0 ? void 0 : employeeInfo.gender,\n                phone: employeeInfo === null || employeeInfo === void 0 ? void 0 : employeeInfo.phone,\n                photoUrl: employeeInfo === null || employeeInfo === void 0 ? void 0 : employeeInfo.photoUrl,\n                teamId: employeeInfo === null || employeeInfo === void 0 ? void 0 : employeeInfo.teamId\n              });\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleGetStaffById(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (employeeId) {\n      handleGetStaffById(employeeId);\n    }\n  }, []);\n\n  var handleSubmitStaff = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(values) {\n      var staffData, certificates, familyRelations, _res$data6, res, _res$data7, _res$data8, _res$data8$data, _res$data8$data$emplo, _res$data9, _res$data10, _res, _res$data11, _res$data12;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              staffData = _objectSpread(_objectSpread({}, values), {}, {\n                photoUrl: fileImage,\n                teamId: values.teamId.toString()\n              });\n              certificates = listDiploma;\n              familyRelations = listRelationship;\n\n              if (!(familyRelations.length === 0)) {\n                _context2.next = 7;\n                break;\n              }\n\n              toast.warning('Thiếu quan hệ gia đình');\n              _context2.next = 22;\n              break;\n\n            case 7:\n              if (!(certificates.length === 0)) {\n                _context2.next = 11;\n                break;\n              }\n\n              toast.warning('Thiếu thông tin văn bằng');\n              _context2.next = 22;\n              break;\n\n            case 11:\n              if (employeeId) {\n                _context2.next = 18;\n                break;\n              }\n\n              _context2.next = 14;\n              return addNewStaff({\n                employeeInfo: staffData,\n                certificates: certificates,\n                familyRelations: familyRelations\n              });\n\n            case 14:\n              res = _context2.sent;\n\n              if ((res === null || res === void 0 ? void 0 : (_res$data6 = res.data) === null || _res$data6 === void 0 ? void 0 : _res$data6.code) === 200) {\n                setIsCheckDisableRegister(false);\n                setStaffInfo(res === null || res === void 0 ? void 0 : (_res$data7 = res.data) === null || _res$data7 === void 0 ? void 0 : _res$data7.data);\n                setEmployeeId(res === null || res === void 0 ? void 0 : (_res$data8 = res.data) === null || _res$data8 === void 0 ? void 0 : (_res$data8$data = _res$data8.data) === null || _res$data8$data === void 0 ? void 0 : (_res$data8$data$emplo = _res$data8$data.employeeInfo) === null || _res$data8$data$emplo === void 0 ? void 0 : _res$data8$data$emplo.employeeId);\n                toast.success('Thêm thành công');\n              } else {\n                toast.warning(res === null || res === void 0 ? void 0 : (_res$data9 = res.data) === null || _res$data9 === void 0 ? void 0 : _res$data9.message);\n              }\n\n              _context2.next = 22;\n              break;\n\n            case 18:\n              _context2.next = 20;\n              return updateStaff({\n                employeeId: employeeId,\n                employeeInfo: staffData,\n                certificates: certificates.map(function (item) {\n                  return {\n                    content: item.content,\n                    educationalOrg: item.educationalOrg,\n                    field: item.field,\n                    issuanceDate: moment(item.issuanceDate).format(\"YYYY-MM-DD\"),\n                    name: item.name,\n                    certificateId: item.certificateId\n                  };\n                }),\n                familyRelations: familyRelations.map(function (item) {\n                  return {\n                    familyRelationId: item.familyId,\n                    name: item.name,\n                    gender: item.gender,\n                    phone: item.phone,\n                    dateOfBirth: moment(item.dateOfBirth).format(\"YYYY-MM-DD\"),\n                    citizenId: item.citizenId,\n                    relation: item.relation,\n                    address: item.address\n                  };\n                })\n              });\n\n            case 20:\n              _res = _context2.sent;\n\n              if ((_res === null || _res === void 0 ? void 0 : (_res$data10 = _res.data) === null || _res$data10 === void 0 ? void 0 : _res$data10.code) === 200) {\n                setStaffInfo(_res === null || _res === void 0 ? void 0 : (_res$data11 = _res.data) === null || _res$data11 === void 0 ? void 0 : _res$data11.data);\n                toast.success('Sửa thành công');\n              } else {\n                toast.warning(_res === null || _res === void 0 ? void 0 : (_res$data12 = _res.data) === null || _res$data12 === void 0 ? void 0 : _res$data12.message);\n              }\n\n            case 22:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleSubmitStaff(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleRegister = function handleRegister() {\n    setShouldOpenDialogRegister(true);\n  };\n\n  var handleCloseDialogRegister = function handleCloseDialogRegister() {\n    setShouldOpenDialogRegister(false);\n  };\n\n  return /*#__PURE__*/React.createElement(Modal, {\n    title: !isEmpty(staffInfo) ? \"Chỉnh sửa nhân viên\" : \"Tạo mới nhân viên\",\n    centered: true,\n    open: open,\n    width: 1000,\n    onCancel: handleClose,\n    footer: null,\n    className: \"modal-staff-info\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    form: form,\n    onFinish: handleSubmitStaff,\n    layout: \"vertical\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"set-scroll\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Tabs, {\n    activeKey: currentTab,\n    onChange: handleTabChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(TabPane, {\n    tab: \"TH\\xD4NG TIN NH\\xC2N VI\\xCAN\",\n    key: \"1\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(TabStaffInformation, {\n    staffInfo: staffInfo,\n    setStaffInfo: setStaffInfo,\n    listGender: listGender,\n    form: form,\n    fileImage: fileImage,\n    setFileImage: setFileImage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(TabPane, {\n    tab: \"QUAN H\\u1EC6 GIA \\u0110\\xCCNH\",\n    key: \"2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(TabFamilyRelationShip, {\n    listRelationship: listRelationship,\n    setListRelationship: setListRelationship,\n    listGender: listGender,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(TabPane, {\n    tab: \"TH\\xD4NG TIN V\\u0102N B\\u1EB0NG\",\n    key: \"3\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(TabDiploma, {\n    listDiploma: listDiploma,\n    setListDiploma: setListDiploma,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 29\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"btn-action\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    className: \"btn-close\",\n    onClick: handleClose,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 21\n    }\n  }, \"H\\u1EE6Y\"), /*#__PURE__*/React.createElement(Button, {\n    disabled: isCheckDisableRegister,\n    className: \"btn-register\",\n    onClick: function onClick() {\n      return handleRegister();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 21\n    }\n  }, \"\\u0110\\u0102NG K\\xDD\"), /*#__PURE__*/React.createElement(Button, {\n    className: \"btn-save\",\n    htmlType: \"submit\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 21\n    }\n  }, \"L\\u01AFU\"), shouldOpenDialogRegister && /*#__PURE__*/React.createElement(DialogRegister, {\n    open: shouldOpenDialogRegister,\n    handleCloseDialogRegister: handleCloseDialogRegister,\n    employeeId: employeeId,\n    handleClose: handleClose,\n    staffInfo: staffInfo,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 25\n    }\n  }))));\n};\n\nexport default DialogStaff;","map":{"version":3,"sources":["D:/DATA/QL_NV/QLNV/src/app/views/CreateStaff/DialogStaff/index.jsx"],"names":["React","Button","Form","Modal","moment","useState","toast","Tabs","TabStaffInformation","TabDiploma","TabFamilyRelationShip","useEffect","DialogRegister","addNewStaff","getStaffById","updateStaff","isEmpty","useDispatch","getFormStaff","TabPane","configure","autoClose","draggable","limit","DialogStaff","open","handleClose","employeeId","setEmployeeId","employeeInfo","listRelationship","setListRelationship","listDiploma","setListDiploma","staffInfo","setStaffInfo","currentTab","setCurrentTab","fileImage","setFileImage","shouldOpenDialogRegister","setShouldOpenDialogRegister","isCheckDisableRegister","setIsCheckDisableRegister","dispatch","listGender","value","label","useForm","form","handleTabChange","tab","validateFields","then","values","catch","errorInfo","console","log","handleGetStaffById","res","data","photoUrl","familyRelations","certificates","setFieldsValue","address","code","citizenId","dateOfBirth","split","email","fullName","gender","phone","teamId","handleSubmitStaff","staffData","toString","length","warning","success","message","map","item","content","educationalOrg","field","issuanceDate","format","name","certificateId","familyRelationId","familyId","relation","handleRegister","handleCloseDialogRegister"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Button, Form, Modal } from 'antd';\r\nimport moment from \"moment\";\r\nimport { useState } from \"react\";\r\nimport { toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport { Tabs } from 'antd';\r\nimport TabStaffInformation from \"./TabStaffInformation\";\r\nimport TabDiploma from \"./TabDiploma\";\r\nimport TabFamilyRelationShip from \"./TabFamilyRelationship\";\r\nimport { useEffect } from \"react\";\r\nimport DialogRegister from \"./DialogRegister\";\r\nimport { addNewStaff, getStaffById, updateStaff } from \"../CreateStaffService\";\r\nimport { isEmpty } from \"lodash\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { getFormStaff } from \"app/redux/actions/CreateStaffAction\";\r\n\r\nconst TabPane = Tabs.TabPane\r\n\r\ntoast.configure({\r\n    autoClose: 500,\r\n    draggable: false,\r\n    limit: 3\r\n});\r\n\r\nconst DialogStaff = ({ open, handleClose, employeeId, setEmployeeId, employeeInfo }) => {\r\n    const [listRelationship, setListRelationship] = useState([]);\r\n    const [listDiploma, setListDiploma] = useState([]);\r\n    const [staffInfo, setStaffInfo] = useState({});\r\n    const [currentTab, setCurrentTab] = useState('1');\r\n    const [fileImage, setFileImage] = useState(\"\");\r\n    const [shouldOpenDialogRegister, setShouldOpenDialogRegister] = useState(false)\r\n    const [isCheckDisableRegister, setIsCheckDisableRegister] = useState(!employeeId)\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    useEffect(() => {\r\n        dispatch(getFormStaff(employeeInfo))\r\n    }, [])\r\n\r\n\r\n    const listGender = [\r\n        { value: 0, label: 'Nam' },\r\n        { value: 1, label: 'Nữ' },\r\n    ];\r\n\r\n    const [form] = Form.useForm();\r\n\r\n    const handleTabChange = (tab) => {\r\n        form.validateFields().then((values) => {\r\n            setCurrentTab(tab);\r\n        }).catch((errorInfo) => {\r\n            console.log('Validate Failed:', errorInfo);\r\n        });\r\n    };\r\n\r\n    const handleGetStaffById = async (employeeId) => {\r\n        const res = await getStaffById({ employeeId })\r\n\r\n        setStaffInfo(res?.data?.data)\r\n        setFileImage(res?.data?.data?.employeeInfo?.photoUrl);\r\n        setListRelationship(res?.data?.data?.familyRelations);\r\n        setListDiploma(res?.data?.data?.certificates)\r\n        const employeeInfo = res?.data?.data?.employeeInfo\r\n\r\n        form.setFieldsValue({\r\n            address: employeeInfo?.address,\r\n            code: employeeInfo?.code,\r\n            citizenId: employeeInfo?.citizenId,\r\n            dateOfBirth: employeeInfo?.dateOfBirth?.split(\" \")[0],\r\n            email: employeeInfo?.email,\r\n            fullName: employeeInfo?.fullName,\r\n            gender: employeeInfo?.gender,\r\n            phone: employeeInfo?.phone,\r\n            photoUrl: employeeInfo?.photoUrl,\r\n            teamId: employeeInfo?.teamId,\r\n        });\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (employeeId) {\r\n            handleGetStaffById(employeeId)\r\n        }\r\n    }, [])\r\n    const handleSubmitStaff = async (values) => {\r\n        const staffData = {\r\n            ...values,\r\n            photoUrl: fileImage,\r\n            teamId: values.teamId.toString(),\r\n        }\r\n\r\n        const certificates = listDiploma;\r\n        const familyRelations = listRelationship\r\n\r\n        if (familyRelations.length === 0) {\r\n            toast.warning('Thiếu quan hệ gia đình')\r\n        } else if (certificates.length === 0) {\r\n            toast.warning('Thiếu thông tin văn bằng')\r\n        } else if (!employeeId) {\r\n            const res = await addNewStaff({ employeeInfo: staffData, certificates, familyRelations })\r\n            if (res?.data?.code === 200) {\r\n                setIsCheckDisableRegister(false);\r\n                setStaffInfo(res?.data?.data);\r\n                setEmployeeId(res?.data?.data?.employeeInfo?.employeeId)\r\n                toast.success('Thêm thành công')\r\n            } else {\r\n                toast.warning(res?.data?.message)\r\n            }\r\n\r\n        } else {\r\n            const res = await updateStaff({\r\n                employeeId: employeeId,\r\n                employeeInfo: staffData,\r\n                certificates: certificates.map((item) => {\r\n                    return {\r\n                        content: item.content,\r\n                        educationalOrg: item.educationalOrg,\r\n                        field: item.field,\r\n                        issuanceDate: moment(item.issuanceDate).format(\"YYYY-MM-DD\"),\r\n                        name: item.name,\r\n                        certificateId: item.certificateId\r\n                    }\r\n                }),\r\n                familyRelations: familyRelations.map((item => {\r\n                    return {\r\n                        familyRelationId: item.familyId,\r\n                        name: item.name,\r\n                        gender: item.gender,\r\n                        phone: item.phone,\r\n                        dateOfBirth: moment(item.dateOfBirth).format(\"YYYY-MM-DD\"),\r\n                        citizenId: item.citizenId,\r\n                        relation: item.relation,\r\n                        address: item.address\r\n                    }\r\n                }))\r\n            })\r\n            if (res?.data?.code === 200) {\r\n                setStaffInfo(res?.data?.data)\r\n                toast.success('Sửa thành công')\r\n            } else {\r\n                toast.warning(res?.data?.message)\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleRegister = () => {\r\n        setShouldOpenDialogRegister(true)\r\n    };\r\n\r\n    const handleCloseDialogRegister = () => {\r\n        setShouldOpenDialogRegister(false)\r\n    }\r\n\r\n    return (\r\n        <Modal\r\n            title={!isEmpty(staffInfo) ? \"Chỉnh sửa nhân viên\" : \"Tạo mới nhân viên\"}\r\n            centered\r\n            open={open}\r\n            width={1000}\r\n            onCancel={handleClose}\r\n            footer={null}\r\n            className=\"modal-staff-info\"\r\n        >\r\n            <Form\r\n                form={form}\r\n                onFinish={handleSubmitStaff}\r\n                layout=\"vertical\"\r\n            >\r\n                <div className=\"set-scroll\">\r\n                    <Tabs activeKey={currentTab} onChange={handleTabChange}>\r\n                        <TabPane tab=\"THÔNG TIN NHÂN VIÊN\" key=\"1\">\r\n                            <TabStaffInformation\r\n                                staffInfo={staffInfo}\r\n                                setStaffInfo={setStaffInfo}\r\n                                listGender={listGender}\r\n                                form={form}\r\n                                fileImage={fileImage}\r\n                                setFileImage={setFileImage}\r\n                            />\r\n                        </TabPane>\r\n                        <TabPane tab=\"QUAN HỆ GIA ĐÌNH\" key=\"2\">\r\n                            <TabFamilyRelationShip\r\n                                listRelationship={listRelationship}\r\n                                setListRelationship={setListRelationship}\r\n                                listGender={listGender}\r\n                            />\r\n                        </TabPane>\r\n                        <TabPane tab=\"THÔNG TIN VĂN BẰNG\" key=\"3\">\r\n                            <TabDiploma\r\n                                listDiploma={listDiploma}\r\n                                setListDiploma={setListDiploma}\r\n                            />\r\n                        </TabPane>\r\n                    </Tabs>\r\n                </div>\r\n\r\n                <div className=\"btn-action\">\r\n                    <Button className=\"btn-close\" onClick={handleClose}>\r\n                        HỦY\r\n                    </Button>\r\n                    <Button disabled={isCheckDisableRegister} className=\"btn-register\" onClick={() => handleRegister()}>\r\n                        ĐĂNG KÝ\r\n                    </Button>\r\n                    <Button className=\"btn-save\" htmlType=\"submit\">\r\n                        LƯU\r\n                    </Button>\r\n                    {shouldOpenDialogRegister && (\r\n                        <DialogRegister\r\n                            open={shouldOpenDialogRegister}\r\n                            handleCloseDialogRegister={handleCloseDialogRegister}\r\n                            employeeId={employeeId}\r\n                            handleClose={handleClose}\r\n                            staffInfo={staffInfo}\r\n                        />\r\n                    )}\r\n                </div>\r\n            </Form>\r\n        </Modal>\r\n    );\r\n}\r\n\r\n\r\nexport default DialogStaff;"]},"metadata":{},"sourceType":"module"}